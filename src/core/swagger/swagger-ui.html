<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>FastAPI Modern Template</title>
    <link rel="stylesheet" type="text/css" href="/swagger/swagger-ui.css" />
    <link rel="icon" type="image/x-icon" href="/swagger/favicon.svg" />
    <style>
        html {
            box-sizing: border-box;
            overflow: -moz-scrollbars-vertical;
            overflow-y: scroll;
        }
        *, *:before, *:after {
            box-sizing: inherit;
        }
        body {
            margin:0;
            background: #fafafa;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏ —Ç–æ–∫–µ–Ω–∞ */
        .auth-container .btn.clear-token {
            background: #ff6b6b !important;
            color: white !important;
            border: 1px solid #ff6b6b !important;
            margin-left: 10px;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn.clear-token {
            margin-left: 15px;
        }
        
        .auth-container .btn.clear-token:hover {
            background: #ff5252 !important;
            border-color: #ff5252 !important;
        }
        
        /* –î–æ–±–∞–≤–ª—è–µ–º –æ—Ç—Å—Ç—É–ø—ã –º–µ–∂–¥—É –∫–Ω–æ–ø–∫–∞–º–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ */
        .auth-container .btn,
        .auth-container button {
            margin-right: 8px;
        }
        
        .auth-container .btn:last-child,
        .auth-container button:last-child {
            margin-right: 0;
        }
        
        /* –°–∫—Ä—ã—Ç–∏–µ topbar –≤ Swagger UI */
        .swagger-ui .topbar {
            display: none !important;
        }
        
        #http-method-select {
            border: 2px solid #333;
            box-sizing: border-box;
        }

        /* –°–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ topbar */
        .swagger-ui .topbar-wrapper,
        .swagger-ui .topbar .download-url-wrapper,
        .swagger-ui .topbar .topbar-wrapper {
            display: none !important;
        }
        
        /* –°–∫—Ä—ã—Ç–∏–µ hgroup.main */
        .swagger-ui hgroup.main {
            display: none !important;
        }
        
        /* –£–±–∏—Ä–∞–µ–º –æ—Ç—Å—Ç—É–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥–ª–∏ –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã topbar */
        .swagger-ui .wrapper {
            padding-top: 0 !important;
        }
        
        .swagger-ui .info {
            margin-top: 0 !important;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞ HTTP –º–µ—Ç–æ–¥–æ–≤ –≤ —Å—Ç–∏–ª–µ Swagger */
        .http-method-filter {
            display: inline-flex;
            align-items: center;
            margin-left: 15px;
            padding: 0;
            background: none;
            border: none;
            position: relative;
        }
        
        .http-method-filter .filter-wrapper {
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .http-method-filter select {
            appearance: none;
            -webkit-appearance: none;
            -moz-appearance: none;
            min-width: 140px;
            padding: 6px 32px 6px 12px;
            border: 1px solid #e3e3e3;
            border-radius: 4px;
            background: white url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24'%3E%3Cpath fill='%23666' d='M7 10l5 5 5-5z'/%3E%3C/svg%3E") no-repeat right 8px center;
            background-size: 16px;
            font-size: 13px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            color: #333;
            cursor: pointer;
            height: 32px;
            line-height: 1;
            transition: all 0.2s ease;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        
        .http-method-filter select:hover {
            border-color: #b3b3b3;
            background-color: #f8f9fa;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .http-method-filter select:focus {
            outline: none;
            border-color: #4990e2;
            background-color: white;
            box-shadow: 0 0 0 3px rgba(73, 144, 226, 0.1);
        }
        
        .http-method-filter select option {
            padding: 8px 12px;
            font-size: 13px;
            background: white;
            color: #333;
            border: none;
        }
        
        .http-method-filter select option:hover {
            background: #f8f9fa;
        }
        
        .http-method-filter select option:checked {
            background: #4990e2;
            color: white;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –æ–ø—Ü–∏–π —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π HTTP –º–µ—Ç–æ–¥–æ–≤ */
        .http-method-filter select option[value="GET"] {
            border-left: 3px solid #61affe;
        }
        
        .http-method-filter select option[value="POST"] {
            border-left: 3px solid #49cc90;
        }
        
        .http-method-filter select option[value="PUT"] {
            border-left: 3px solid #fca130;
        }
        
        .http-method-filter select option[value="PATCH"] {
            border-left: 3px solid #50e3c2;
        }
        
        .http-method-filter select option[value="DELETE"] {
            border-left: 3px solid #f93e3e;
        }
        
        .http-method-filter select option[value="HEAD"] {
            border-left: 3px solid #9012fe;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º —Ñ–∏–ª—å—Ç—Ä–æ–º Swagger */
        .swagger-ui .filter {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .swagger-ui .filter .http-method-filter {
            margin-left: 0;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 768px) {
            .http-method-filter {
                margin-left: 10px;
                margin-top: 8px;
            }
            
            .http-method-filter select {
                min-width: 120px;
                font-size: 12px;
                height: 28px;
                padding: 4px 28px 4px 10px;
            }
            
            .swagger-ui .filter {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
        
        /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ (–µ—Å–ª–∏ Swagger –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–º–Ω—É—é —Ç–µ–º—É) */
        .swagger-ui .http-method-filter select {
            background-color: white;
            border-color: #4a5568;
            color: #333;
        }
        
        .swagger-ui .http-method-filter select:hover {
            background-color: #f8f9fa;
            border-color: #718096;
        }
        
        .swagger-ui .http-method-filter select:focus {
            border-color: #63b3ed;
            background-color: white;
        }
        
        .swagger-ui .http-method-filter select option {
            background: white;
            color: #333;
        }
        
        .swagger-ui .http-method-filter select option:hover {
            background: #f8f9fa;
        }
        
        .swagger-ui .http-method-filter select option:checked {
            background: #63b3ed;
            color: white;
        }
        
        .filter-controls {
            display: flex;
            gap: 8px;
            align-items: center;
            margin-left: auto;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 6px 12px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            white-space: nowrap;
            transition: background-color 0.2s;
        }
        
        .filter-btn:hover {
            background: #0056b3;
        }
        
        .filter-btn.secondary {
            background: #6c757d;
        }
        
        .filter-btn.secondary:hover {
            background: #545b62;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
        @media (max-width: 768px) {
            .http-method-filter {
                margin-left: 10px;
                margin-top: 10px;
            }
            
            .http-method-filter select {
                min-width: 100px;
                font-size: 11px;
            }
            
            .filter-controls {
                margin-left: 0;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div id="swagger-ui"></div>

    <!-- Load Swagger UI -->
    <script src="https://unpkg.com/swagger-ui-dist/swagger-ui-bundle.js"></script>
    <script src="https://unpkg.com/swagger-ui-dist/swagger-ui-standalone-preset.js"></script>
    
    <!-- Load the HierarchicalTags Plugin -->
    <script src="https://unpkg.com/swagger-ui-plugin-hierarchical-tags"></script>

    <script>
        // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è localStorage
        const TOKEN_STORAGE_KEY = 'swagger_auth_token';
        const TOKEN_TYPE_STORAGE_KEY = 'swagger_auth_token_type';
        const HTTP_METHOD_FILTER_KEY = 'swagger_http_method_filter';

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–æ–º
        function saveTokenToStorage(token, tokenType = 'Bearer') {
            try {
                localStorage.setItem(TOKEN_STORAGE_KEY, token);
                localStorage.setItem(TOKEN_TYPE_STORAGE_KEY, tokenType);
            } catch (e) {
                // –¢–æ–∫–µ–Ω –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω
            }
        }

        function loadTokenFromStorage() {
            try {
                const token = localStorage.getItem(TOKEN_STORAGE_KEY);
                const tokenType = localStorage.getItem(TOKEN_TYPE_STORAGE_KEY) || 'Bearer';
                return token ? { token, tokenType } : null;
            } catch (e) {
                return null;
            }
        }

        function clearTokenFromStorage() {
            try {
                localStorage.removeItem(TOKEN_STORAGE_KEY);
                localStorage.removeItem(TOKEN_TYPE_STORAGE_KEY);
            } catch (e) {
                // –¢–æ–∫–µ–Ω –Ω–µ —É–¥–∞–ª–µ–Ω
            }
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ñ–∏–ª—å—Ç—Ä–æ–º HTTP –º–µ—Ç–æ–¥–æ–≤
        function saveHttpMethodFilter(filterState) {
            try {
                localStorage.setItem(HTTP_METHOD_FILTER_KEY, JSON.stringify(filterState));
            } catch (e) {
                // –§–∏–ª—å—Ç—Ä –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω
            }
        }

        function loadHttpMethodFilter() {
            try {
                const saved = localStorage.getItem(HTTP_METHOD_FILTER_KEY);
                return saved ? JSON.parse(saved) : getDefaultFilterState();
            } catch (e) {
                return getDefaultFilterState();
            }
        }

        function getDefaultFilterState() {
            return {
                selectedMethod: ""
            };
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ HTTP –º–µ—Ç–æ–¥–æ–≤
        function initializeHttpMethodFilter() {
            const select = document.querySelector('#http-method-select');
            if (!select) {
                console.warn('HTTP method filter select not found');
                return;
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            const savedState = loadHttpMethodFilter();
            if (savedState.selectedMethod) {
                select.value = savedState.selectedMethod;
            }

            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—ã–±–æ—Ä–∞
            select.addEventListener('change', function() {
                console.log('HTTP method filter changed to:', this.value);
                applyHttpMethodFilter();
            });
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
            setTimeout(() => {
                applyHttpMethodFilter();
            }, 100);
            
            console.log('HTTP method filter initialized successfully');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ HTTP –º–µ—Ç–æ–¥–æ–≤ (–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
        function createHttpMethodFilter() {
            const filterContainer = document.createElement('div');
            filterContainer.className = 'http-method-filter';
            filterContainer.innerHTML = `
                <div class="filter-wrapper">
                    <select id="http-method-select" title="Filter by HTTP method">
                        <option value="">All methods</option>
                        <option value="GET">GET</option>
                        <option value="POST">POST</option>
                        <option value="PUT">PUT</option>
                        <option value="PATCH">PATCH</option>
                        <option value="DELETE">DELETE</option>
                    </select>
                </div>
            `;

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            const savedState = loadHttpMethodFilter();
            const select = filterContainer.querySelector('#http-method-select');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
            if (savedState.selectedMethod) {
                select.value = savedState.selectedMethod;
            }

            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—ã–±–æ—Ä–∞
            select.addEventListener('change', function() {
                applyHttpMethodFilter();
            });

            return filterContainer;
        }

        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ HTTP –º–µ—Ç–æ–¥–æ–≤
        function applyHttpMethodFilter() {
            const select = document.querySelector('#http-method-select');
            const selectedMethod = select ? select.value : "";
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
            saveHttpMethodFilter({ selectedMethod });

            // –ò—â–µ–º –≤—Å–µ –±–ª–æ–∫–∏ –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏
            const operations = document.querySelectorAll('.opblock, .operation-tag-content .opblock');
            
            operations.forEach(operation => {
                // –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç —Å –º–µ—Ç–æ–¥–æ–º HTTP —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤–æ–∑–º–æ–∂–Ω—ã–º–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏
                const methodElement = operation.querySelector('.opblock-summary-method, .opblock-summary-operation-id, [data-http-method]');
                
                if (methodElement) {
                    let method = methodElement.textContent.trim();
                    
                    // –ï—Å–ª–∏ –º–µ—Ç–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ç–µ–∫—Å—Ç–µ, –ø—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ data-–∞—Ç—Ä–∏–±—É—Ç–∞
                    if (!method && methodElement.getAttribute('data-http-method')) {
                        method = methodElement.getAttribute('data-http-method');
                    }
                    
                    // –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ—Ç –º–µ—Ç–æ–¥–∞, –ø—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–∞—Ö
                    if (!method) {
                        const parentMethodElement = operation.closest('.opblock')?.querySelector('.opblock-summary-method');
                        if (parentMethodElement) {
                            method = parentMethodElement.textContent.trim();
                        }
                    }
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä
                    const isVisible = !selectedMethod || method.toUpperCase() === selectedMethod.toUpperCase();
                    operation.style.display = isVisible ? '' : 'none';
                }
            });
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏—â–µ–º –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏—è—Ö Swagger UI
            const newOperations = document.querySelectorAll('[data-http-method]');
            newOperations.forEach(operation => {
                const method = operation.getAttribute('data-http-method');
                const opBlock = operation.closest('.opblock, .operation-tag-content');
                
                if (opBlock && method) {
                    const isVisible = !selectedMethod || method.toUpperCase() === selectedMethod.toUpperCase();
                    opBlock.style.display = isVisible ? '' : 'none';
                }
            });
        }

        // –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–∞ HTTP –º–µ—Ç–æ–¥–æ–≤
        function resetHttpMethodFilter() {
            const select = document.querySelector('#http-method-select');
            if (select) {
                select.value = "";
                applyHttpMethodFilter();
            }
        }

        // –í—ã–±–æ—Ä –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
        function selectAllMethods() {
            const select = document.querySelector('#http-method-select');
            if (select) {
                select.value = ""; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
                applyHttpMethodFilter();
            }
        }

        // –°–Ω—è—Ç–∏–µ –≤—ã–±–æ—Ä–∞ —Å–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤
        function deselectAllMethods() {
            const select = document.querySelector('#http-method-select');
            if (select) {
                select.value = ""; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—ã–±–æ—Ä
                applyHttpMethodFilter();
            }
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –æ—á–∏—Å—Ç–∫–∏ —Ç–æ–∫–µ–Ω–∞
        function addClearTokenButton() {
            // –û–∂–∏–¥–∞–µ–º –ø–æ—è–≤–ª–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            const checkForAuthSection = setInterval(() => {
                const authSection = document.querySelector('.auth-wrapper');
                if (authSection) {
                    clearInterval(checkForAuthSection);
                    
                    // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫—É –æ—á–∏—Å—Ç–∫–∏
                    const clearButton = document.createElement('button');
                    clearButton.className = 'btn clear-token';
                    clearButton.textContent = 'üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–∫–µ–Ω';
                    clearButton.title = '–£–¥–∞–ª–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞';
                    
                    clearButton.onclick = function() {
                        if (confirm('–£–¥–∞–ª–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω? –≠—Ç–æ –≤—ã–ø–æ–ª–Ω–∏—Ç –≤—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã.')) {
                            clearTokenFromStorage();
                            // –û–±–Ω–æ–≤–ª—è–µ–º UI
                            if (window.ui) {
                                window.ui.authActions.logout(['OAuth2PasswordBearer']);
                            }
                            location.reload();
                        }
                    };
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                    const authContainer = authSection.querySelector('.auth-container') || authSection;
                    authContainer.appendChild(clearButton);
                }
            }, 100);
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
            setTimeout(() => clearInterval(checkForAuthSection), 10000);
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ HTTP –º–µ—Ç–æ–¥–æ–≤
        function addHttpMethodFilter() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –ª–∏ —É–∂–µ —Ñ–∏–ª—å—Ç—Ä
            if (document.querySelector('.http-method-filter')) {
                console.log('HTTP method filter already exists, skipping...');
                return;
            }
            
            // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ø—ã—Ç–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
            function attemptAddFilter() {
                // –ò—â–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ–∏–ª—å—Ç—Ä Swagger UI
                const existingFilter = document.querySelector('.swagger-ui .filter');
                if (existingFilter) {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—â–µ —Ä–∞–∑, –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –ª–∏ —É–∂–µ —Ñ–∏–ª—å—Ç—Ä
                    if (existingFilter.querySelector('.http-method-filter')) {
                        console.log('HTTP method filter already exists in existing filter, skipping...');
                        return true;
                    }
                    
                    // –°–æ–∑–¥–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä HTTP –º–µ—Ç–æ–¥–æ–≤
                    const filter = createHttpMethodFilter();
                    existingFilter.appendChild(filter);
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ñ–∏–ª—å—Ç—Ä
                    initializeHttpMethodFilter();
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
                    setTimeout(() => {
                        applyHttpMethodFilter();
                        console.log('HTTP method filter applied successfully');
                    }, 500);
                    
                    return true;
                }
                
                // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ –º–µ—Å—Ç–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
                const possibleContainers = [
                    document.querySelector('.auth-wrapper'),
                    document.querySelector('.auth-container'),
                    document.querySelector('.swagger-ui .topbar'),
                    document.querySelector('.swagger-ui .info'),
                    document.querySelector('.swagger-ui .scheme-container')
                ].filter(Boolean);
                
                if (possibleContainers.length > 0) {
                    const container = possibleContainers[0];
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—â–µ —Ä–∞–∑, –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω –ª–∏ —É–∂–µ —Ñ–∏–ª—å—Ç—Ä
                    if (container.querySelector('.http-method-filter')) {
                        console.log('HTTP method filter already exists in alternative container, skipping...');
                        return true;
                    }
                    
                    // –°–æ–∑–¥–∞–µ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä
                    const filter = createHttpMethodFilter();
                    container.appendChild(filter);
                    
                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ñ–∏–ª—å—Ç—Ä
                    initializeHttpMethodFilter();
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
                    setTimeout(() => {
                        applyHttpMethodFilter();
                        console.log('HTTP method filter applied successfully');
                    }, 500);
                    
                    return true;
                }
                
                return false;
            }
            
            // –ü—ã—Ç–∞–µ–º—Å—è –¥–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º
            let attempts = 0;
            const maxAttempts = 20;
            
            const addFilterInterval = setInterval(() => {
                attempts++;
                
                if (attemptAddFilter()) {
                    clearInterval(addFilterInterval);
                    return;
                }
                
                if (attempts >= maxAttempts) {
                    clearInterval(addFilterInterval);
                    console.warn('Failed to add HTTP method filter after', maxAttempts, 'attempts');
                }
            }, 200);
        }

        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
        function restoreFilterState() {
            const select = document.querySelector('#http-method-select');
            if (select) {
                const savedState = loadHttpMethodFilter();
                if (savedState.selectedMethod) {
                    select.value = savedState.selectedMethod;
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                    setTimeout(() => {
                        applyHttpMethodFilter();
                    }, 200);
                }
            }
        }

        // –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π URL –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
        function setupUrlChangeDetection() {
            let currentUrl = location.href;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è URL –∫–∞–∂–¥—ã–µ 100–º—Å
            setInterval(() => {
                if (location.href !== currentUrl) {
                    currentUrl = location.href;
                    
                    // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä
                    setTimeout(() => {
                        restoreFilterState();
                    }, 1000);
                }
            }, 100);
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ DOM –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
            const observer = new MutationObserver((mutations) => {
                let shouldRestore = false;
                
                mutations.forEach((mutation) => {
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–æ–±–∞–≤–∏–ª–∏—Å—å –ª–∏ –Ω–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
                    if (mutation.type === 'childList' && mutation.addedNodes.length > 0) {
                        mutation.addedNodes.forEach((node) => {
                            if (node.nodeType === Node.ELEMENT_NODE) {
                                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–µ–ª–µ–∫—Ç–æ—Ä—ã –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π
                                if (node.classList && (
                                    node.classList.contains('opblock') ||
                                    node.classList.contains('operation-tag-content')
                                )) {
                                    shouldRestore = true;
                                }
                                if (node.querySelector && (
                                    node.querySelector('.opblock') ||
                                    node.querySelector('.operation-tag-content') ||
                                    node.querySelector('[data-http-method]')
                                )) {
                                    shouldRestore = true;
                                }
                            }
                        });
                    }
                });
                
                if (shouldRestore) {
                    setTimeout(() => {
                        restoreFilterState();
                    }, 500);
                }
            });
            
            // –ù–∞–±–ª—é–¥–∞–µ–º –∑–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
            const swaggerContainer = document.querySelector('#swagger-ui');
            if (swaggerContainer) {
                observer.observe(swaggerContainer, {
                    childList: true,
                    subtree: true
                });
            }
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
            window.addEventListener('resize', () => {
                setTimeout(() => {
                    applyHttpMethodFilter();
                }, 100);
            });
        }

        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞
        function forceApplyFilter() {
            // –ñ–¥–µ–º –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ DOM
            setTimeout(() => {
                applyHttpMethodFilter();
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ 1 —Å–µ–∫—É–Ω–¥—É
                setTimeout(() => {
                    applyHttpMethodFilter();
                }, 1000);
                
                // –ò –µ—â–µ —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
                setTimeout(() => {
                    applyHttpMethodFilter();
                }, 2000);
            }, 100);
        }

        window.onload = function() {
            const ui = SwaggerUIBundle({
                url: '{{openapi_url}}',
                dom_id: '#swagger-ui',
                deepLinking: true,
                presets: [
                    SwaggerUIBundle.presets.apis,
                    SwaggerUIStandalonePreset
                ],
                plugins: [
                    SwaggerUIBundle.plugins.DownloadUrl,
                    HierarchicalTagsPlugin
                ],
                layout: "StandaloneLayout",
                hierarchicalTagSeparator: /[:|]/,
                docExpansion: "list",
                filter: true,
                showExtensions: true,
                showCommonExtensions: true,
                
                onComplete: function() {
                    console.log('Swagger UI loaded completely');
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ç–æ–∫–µ–Ω
                    const savedAuth = loadTokenFromStorage();
                    if (savedAuth) {
                        ui.authActions.authorize({
                            OAuth2PasswordBearer: {
                                name: 'OAuth2PasswordBearer',
                                schema: {
                                    type: 'oauth2',
                                    flows: {
                                        password: {
                                            tokenUrl: 'token',
                                            scopes: {}
                                        }
                                    }
                                },
                                value: savedAuth.token
                            }
                        });
                    }
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –æ—á–∏—Å—Ç–∫–∏ —Ç–æ–∫–µ–Ω–∞
                    addClearTokenButton();
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä HTTP –º–µ—Ç–æ–¥–æ–≤
                    addHttpMethodFilter();

                    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
                    restoreFilterState();

                    // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è URL –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞
                    setupUrlChangeDetection();
                    
                    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä
                    forceApplyFilter();
                }
            });

            window.ui = ui;
            
            // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
            const originalAuthorize = ui.authActions.authorize;
            ui.authActions.authorize = function(data) {
                const result = originalAuthorize.call(this, data);
                if (data && data.OAuth2PasswordBearer && data.OAuth2PasswordBearer.value) {
                    saveTokenToStorage(data.OAuth2PasswordBearer.value, 'Bearer');
                }
                return result;
            };
            
            const originalLogout = ui.authActions.logout;
            ui.authActions.logout = function(authNames) {
                if (authNames && authNames.includes('OAuth2PasswordBearer')) {
                    clearTokenFromStorage();
                }
                return originalLogout.call(this, authNames);
            };
        };

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded');
            // –£–±–∏—Ä–∞–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã - —Ñ–∏–ª—å—Ç—Ä –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ onComplete
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            console.log('Window loaded');
            // –£–±–∏—Ä–∞–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã - —Ñ–∏–ª—å—Ç—Ä –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ onComplete
        });
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden) {
                // –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å—Ç–∞–ª–∞ –≤–∏–¥–∏–º–æ–π, –ø—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä
                setTimeout(() => {
                    applyHttpMethodFilter();
                }, 500);
            }
        });
    </script>
</body>
</html>
